(begin-tx)

(interface test1
  @doc "Test to make sure interface global models and function \
      \ models are concatenated properly in implementing modules"
  @model
    [ (defproperty negb_involution (= (not (not true)) true))
      (defproperty negb_inversion (= false (not true)))
      (defproperty integer_id (= x x))
    ]


  (defun f1:bool (x:bool))
  (defun f2:bool (y:bool))
  (defun f3:integer (x:integer))
)

(commit-tx)
(begin-tx)

(define-keyset 'test-keyset (sig-keyset))
(module mod-test 'test-keyset
  @doc "Module implementing test1"

  (implements test1)

  (defun f1:bool (x:bool)
    @model
    [ (property negb_inversion)
      (property negb_involution) ]
    x)

  (defun f2:bool (y:bool)
    @model
    [ (property negb_inversion)
      (property negb_involution) ]
    (not y))

  (defun f3:integer (x:integer)
    @model [ (property integer_id) ]
    x)
)

(commit-tx)

(verify 'mod-test)
